<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Gap Web — Create Account</title>
<link rel="icon" href="favicon.ico" />
<style>
/* =========================
   Gap Web — Signup Styles
   ========================= */
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap');
:root{
  --bg:#f3f6fb;
  --card:#ffffff;
  --primary:#0d0a4c;
  --accent:#0d6efd;
  --danger:#e74c3c;
  --muted:#6b7280;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:'Poppins',sans-serif;
  background:linear-gradient(180deg,#07102a 0%, #0d0a4c 60%);
  display:flex;
  align-items:center;
  justify-content:center;
  padding:30px;
  color: #0b1220;
}

/* card */
.container{
  width:880px;
  max-width:95%;
  display:grid;
  grid-template-columns: 1fr 420px;
  gap:28px;
  align-items:center;
}

/* left: hero */
.hero {
  color: white;
  padding:36px;
  border-radius:16px;
  background: linear-gradient(135deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
  box-shadow: 0 20px 50px rgba(2,6,23,0.6);
  min-height:360px;
}
.logo { font-weight:700; font-size:26px; letter-spacing:0.6px; margin-bottom:10px; }
.hero h1 { font-size:28px; margin:14px 0 8px; }
.hero p { color: rgba(255,255,255,0.85); line-height:1.55; margin-bottom:18px; }
.hero ul { color: rgba(255,255,255,0.95); margin-top:12px; padding-left:18px; }
.hero li { margin:8px 0; }

/* right: form card */
.card {
  background: var(--card);
  border-radius:14px;
  padding:22px;
  box-shadow: 0 12px 30px rgba(2,6,23,0.25);
}
h2 { margin:0 0 8px 0; color:var(--primary); }
.sub { margin-bottom:18px; color:var(--muted); font-size:14px; }

/* inputs */
.input-row { display:flex; gap:10px; margin-bottom:12px; }
.input-row .input{ flex:1; }
.input {
  width:100%;
  padding:12px 14px;
  border-radius:10px;
  border:1px solid #e6e9ef;
  font-size:15px;
  outline:none;
}
.input:focus { box-shadow:0 6px 20px rgba(13,10,76,0.06); border-color:var(--accent); }

/* buttons */
.btn {
  display:inline-block;
  width:100%;
  padding:12px;
  border-radius:10px;
  background:var(--primary);
  color:white;
  border:none;
  cursor:pointer;
  font-weight:600;
  margin-top:8px;
}
.btn.secondary {
  background:transparent;
  border:1px solid #e6e9ef;
  color:var(--primary);
}

/* small text */
.note { font-size:13px; color:var(--muted); margin-top:12px; text-align:center; }

/* responsive */
@media(max-width:880px){
  .container{ grid-template-columns: 1fr; }
  .hero{ order:2 }
  .card{ order:1 }
}
</style>
</head>
<body>

<div class="container">

  <!-- HERO -->
  <div class="hero">
    <div class="logo">Gap Web</div>
    <h1>Create account — get your dashboard</h1>
    <p>Sign up now to access your Gap Web dashboard where you can view your plans, manage your profile, and contact support. We store your account in Firebase Realtime Database (no Firebase Auth used).</p>
    <ul>
      <li>Simple signup — name, email, phone & password</li>
      <li>Fast dashboard access after login</li>
      <li>Easily link to orders and plans (we'll show how in dashboard)</li>
    </ul>
    <p style="margin-top:22px;font-size:13px;opacity:.9">Tip: use a real email you used to buy so the dashboard can show your purchase details from the `payments` node.</p>
  </div>

  <!-- FORM -->
  <div class="card" id="signupCard">
    <h2>Create your Gap Web account</h2>
    <div class="sub">All fields required. We store your data in Firebase Realtime DB.</div>

    <div style="margin-bottom:8px;">
      <div class="input-row">
        <input id="name" class="input" placeholder="Full Name" />
      </div>

      <div class="input-row">
        <input id="email" class="input" placeholder="Email (example@gmail.com)" />
      </div>

      <div class="input-row">
        <input id="phone" class="input" placeholder="Whatsapp / Phone number" />
      </div>

      <div class="input-row">
        <input id="password" type="password" class="input" placeholder="Password (min 6 chars)" />
      </div>

      <button class="btn" onclick="registerUser()">Create Account</button>
      <button class="btn secondary" onclick="goToLogin()">Already have an account? Login</button>

      <div id="msg" class="note"></div>
    </div>

    <!-- small footer -->
    <div style="margin-top:14px;font-size:12px;color:#777;text-align:center">
      By creating an account you agree to Gap Web's <a href="#" style="color:var(--primary)">Terms & Privacy</a>.
    </div>
  </div>
</div>

<!-- Firebase + Logic -->
<script type="module">
/*
  Single-file Signup logic using Firebase Realtime Database.
  Creates a user record under /users with a push key.
  If email already exists — prevents duplicate.
*/

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getDatabase, ref, get, push, set } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

// ---------- Firebase config ----------
const firebaseConfig = {
  apiKey: "AIzaSyANDJRYu6r-DczEoSscILdnCLpMCwX-UvM",
  authDomain: "payments-5802a.firebaseapp.com",
  databaseURL: "https://payments-5802a-default-rtdb.firebaseio.com",
  projectId: "payments-5802a",
  storageBucket: "payments-5802a.firebasestorage.app",
  messagingSenderId: "467232488937",
  appId: "1:467232488937:web:79680dbf4fed78a3201f78"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// helpers to access DOM
const _ = id => document.getElementById(id);
const msgEl = _("msg");

// navigation to login page
function goToLogin(){
  window.location.href = "login.html";
}
window.goToLogin = goToLogin;

// validation util
function validateEmail(email){
  return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
}

// register user
window.registerUser = async function(){
  msgEl.textContent = "";
  const name = _("name").value.trim();
  const email = _("email").value.trim().toLowerCase();
  const phone = _("phone").value.trim();
  const password = _("password").value;

  if(!name || !email || !phone || !password){
    msgEl.textContent = "Please fill all fields.";
    return;
  }
  if(password.length < 6){
    msgEl.textContent = "Password must be at least 6 characters.";
    return;
  }
  if(!validateEmail(email)){
    msgEl.textContent = "Please enter a valid email.";
    return;
  }

  try {
    msgEl.textContent = "Checking existing accounts...";
    const usersRef = ref(db, "users");
    const snapshot = await get(usersRef);

    // if users exist, check duplicates
    if(snapshot.exists()){
      const all = snapshot.val();
      // quick loop check for same email
      for(const k in all){
        if(all[k].email && all[k].email.toLowerCase() === email){
          msgEl.textContent = "An account with this email already exists. Please login.";
          return;
        }
      }
    }

    msgEl.textContent = "Creating account...";
    const newUserRef = push(usersRef);
    const now = new Date().toISOString();
    await set(newUserRef, {
      name, email, phone, password, createdAt: now
    });

    msgEl.style.color = "green";
    msgEl.textContent = "Account created successfully. Redirecting to login...";
    setTimeout(()=> window.location.href = "login.html", 900);

  } catch(err){
    console.error(err);
    msgEl.style.color = "#e74c3c";
    msgEl.textContent = "Error creating account: " + (err.message || err);
  }
};
</script>
</body>
</html>
